<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="Data Processing Reference|Preliminary Processing">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>EddyPro 5 Help | Calculating Spectra, Cospectra, and Ogives</title>
        <script>/* <![CDATA[ */
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-22299342-5', 'licor.com');
			ga('send', 'pageview');

		/* ]]> */</script>
        <link href="Resources/Fonts/OpenSans-Regular-webfont.eot" rel="font" />
        <link href="Resources/Fonts/OpenSans-Regular-webfont.svg" rel="font" />
        <link href="Resources/Fonts/OpenSans-Regular-webfont.ttf" rel="font" />
        <link href="Resources/Fonts/OpenSans-Bold-webfont.woff" rel="font" />
        <link href="Resources/Fonts/OpenSans-Bold-webfont.eot" rel="font" />
        <link href="Resources/Fonts/OpenSans-Bold-webfont.svg" rel="font" />
        <link href="Resources/Fonts/OpenSans-Bold-webfont.ttf" rel="font" />
        <link href="Resources/Fonts/OpenSans-Bold-webfont.woff" rel="font" />
        <link href="../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="Resources/Stylesheets/HelpEnv.css" rel="stylesheet" />
        <script src="../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../Resources/Scripts/require.min.js">
        </script>
        <script src="../Resources/Scripts/require.config.js">
        </script>
        <script src="../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../index.htm#Calculating_Spectra_Cospectra_and_Ogives.htm">Open topic with navigation</a>
        </p>
        <div class="wrapper">
            <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">EddyPro 5 Help &gt; </span><span class="MCBreadcrumbsSelf">Data Processing Reference</span><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbsSelf">Preliminary Processing</span><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Calculating Spectra, Cospectra, and Ogives</span>
            </div>
            <div class="resources">
                <p style="color:#0072B2; font-size:19px; font-style: italic; font-weight: 600; line-height: 22px; margin-bottom: 15 px; text-shadow: 0 1 px 1 px #ffffff;">Resources:</p>
                <ul style="margin-left: -15px;">
                    <li value="1"><a href="Video_Library.htm">Video Tutorials</a>
                    </li>
                    <li value="2"><a href="https://licor.box.com/s/qmhucid6g0hdvd3d13tk" target="_blank">Overview of EddyPro Work-flows</a>
                    </li>
                    <li value="3"><a href="https://licor.box.com/s/1ium2zmwm6hl36yz9bu4" target="_blank">Printable PDF Manual</a>
                    </li>
                    <li value="4"><a href="http://www.licor.com/env/forum/forum.php?id=8" target="_parent"><span class="MyVariablesSoftwareName">EddyPro</span> Forum</a>
                    </li>
                </ul>
            </div>
            <h1>Calculating Spectra, Cospectra, and Ogives</h1>
            <p><span class="MyVariablesSoftwareName R">EddyPro®</span> allows calculation and output of most relevant spectra and cospectra. Namely spectra are available for the three wind components, the sonic temperature (or the alternative fast temperature reading used in place of sonic temperature, as applicable) and the gas concentrations/densities. Similarly, cospectra are available for covariances of w (vertical wind component) and all such variables. In the remainder of this paragraph we use the wording “(co)spectra” to refer to both spectra and cospectra.</p>
            <p>(Co)spectra are calculated after raw data have been fully processed, including the compensation of time lags, and are available in two different formats: either “full” or “binned”. Full (co)spectra are calculated for each flux averaging period and contain a number of frequencies equal to half the number of raw records. As an example, a raw dataset of 18000 records (30 minutes at 10 Hz) will provide (co)spectra specified for 9000 frequencies, linearly distributed between the lower frequency of 1/(30 minutes) and the maximum frequency (the Nyquist frequency) of (10 Hz)/2. One property of full (co)spectra is that their integration over the entire frequency range provides the (co)variance of the concerned variables. For details on the derivation and interpretation of spectra and cospectra refer, for example, to <a href="References.htm#Smith">Smith (1998)</a>. </p>
            <p>However, the full (co)spectra dataset is difficult to handle because of the size of each individual (co)spectrum, and difficult to interpret because of the noise that typically affects the medium and high-frequency ranges. For these reasons, <span class="MyVariablesSoftwareName">EddyPro</span> also calculates and outputs reduced, or “binned” (co)spectra. The reduction procedure consists in dividing the frequency range in a user-specified number of exponentially spaced frequency bins (e.g. 100) and averaging individual (co)spectral values that fall within each bin. The exponential nature of the size increase of the bins assures that increasingly more spectral values are averaged as it moves toward higher frequencies, thereby increasingly reducing noise. The figure below shows an example of a full spectrum and the corresponding binned version.</p>
            <p>Calculation of the full (co)spectra involves the following sequence of operations:</p>
            <ol class="ml96pt">
                <li value="1">First, if one selects this option, raw time series are limited to a number of records equal to the power-of-two closest to the available number of records for the current flux averaging period. This step guarantees that the Fourier transforms are performed at the fastest speed possible. If you do not select this option, all available samples are used, but the computation slows down.</li>
                <li value="2">If applicable, statistics (variances and covariances) are now re-evaluated on the reduced time series and used later for (co)spectra normalization.</li>
                <li value="3">Fourier transform is performed by means of an FFT (Fast Fourier Transform) algorithm. </li>
                <li value="4">Full (co)spectra can now be calculated and output as selected by the user.</li>
            </ol>
            <p>This procedure ensures that (co)spectra are such that their integration provides the corresponding (co)variances, as stated above.</p>
            <p class="img"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="Resources/Images/Spectrum.png"><img class="MCPopupThumbnail img imgwidth250pt" data-mc-width="392" data-mc-height="308" src="Resources/Images/Spectrum_thumb_0_96.png" tabindex="" /></a>
            </p>
            <p>The calculation of binned (co)spectra involves a slightly different sequence of steps:</p>
            <ol class="ml96pt">
                <li value="1">First, if you select this option, raw time series are limited to a number of records equal to power of two closest to the available number of records for the current flux averaging period. This step guarantees that the Fourier transforms are performed at the fastest speed possible.</li>
                <li value="2">If applicable, statistics (variances and covariances) are now re-evaluated on the reduced time series and used later for (co)spectra normalization.</li>
                <li value="3">The reduced time series is now “tapered” using the selected tapering window. The tapering, (or windowing) procedure consists in multiplying (in a scalar sense) the time series with a suitable symmetric function. The aim, which you can learn in detail in <a href="References.htm#Smith">Smith (1998)</a>, is to produce a time series that can be thought of as a part of an infinite periodic time series, to which the definition of discrete (co)spectra actually applies. Not applying the tapering procedure to short time series can result in spectral power overestimation. <a href="References.htm#Kaimal2">Kaimal and Kristensen (1991)</a> suggested the use of the Hamming or the Hann windows. The figure below shows examples of tapering windows and the effect of their application to a time series. Also shown are the effects that different windows have on a sample spectrum.                </li>
                <li value="4">The FFT is now applied to tapered time series are and full (co)spectra are calculated.</li>
                <li value="5">Full (co)spectra are normalized using relevant (co)variances.      </li>
                <li value="6">Full (co)spectra are finally reduced into the exponentially spaced frequency base.
                </li>
                <li value="7">As a further option, <span class="MyVariablesSoftwareName">EddyPro</span> calculates and outputs ogives of all (co)spectra. At each given frequency, the ogive is simply the integration of the (co)spectrum from the current frequency to the Nyquist frequency. It can be thought of as a cumulative (co)spectrum, while its value at the lowest frequency provides the integration of the full (co)spectrum (i.e., the (co)variance). Ogives can be used to evaluate the suitability of the chosen flux averaging period.</li>
            </ol>
            <p class="img"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="Resources/Images/Tapering.png"><img class="MCPopupThumbnail img" data-mc-width="472" data-mc-height="353" src="Resources/Images/Tapering_thumb_0_96.png" tabindex="" /></a>
            </p>
            <caption class="figure" data-mc-autonum="Figure 21"><span class="autonumber"><span>Figure 21</span></span>. Top left: Shape of tapering windows available in EddyPro. Top right: Effect of different tapering windows on a sample spectrum. Bottom: Effect (red) of the Bartlett window on a raw (gray) time series.</caption>
            <div class="push">
            </div>
        </div>
        <div class="foot">
            <div style="float:left;">
                <p class="footer">Product Information:</p>
                <ul class="footer" style="padding-left: 10px;padding-top: 3px;">
                    <li class="nb" style="font-size: 0.8em;" value="1">EddyPro 5 Eddy Covariance Software</li>
                    <li class="nb" style="font-size: 0.8em;" value="2">Help updated on: <span class="SystemShortDate">11/7/2014</span></li>
                </ul>
                <p class="footer">© 2011 - 2014 LI-COR, Inc.</p>
            </div>
            <div style="float:right;">
                <p class="footer">Contact Us:</p>
                <ul class="footer" style="padding-left: 10px;padding-top: 3px;">
                    <li class="nb" value="1"><a class="footer" href="mailto:envsupport@licor.com" title="Email LI-COR support" alt="Email LI-COR support" style="font-size: 0.8em; text-decoration: none;">envsupport@licor.com</a>
                    </li>
                    <li class="nb" value="2"><a class="footer" href="http://www.licor.com/env" title="Go to the LI-COR website" target="_blank" alt="Go to the LI-COR website" style="text-decoration: none; font-size: 0.8em;">www.licor.com/env</a>
                    </li>
                    <li class="nb" style="font-size: 0.8em;" value="3">International: 1-402-467-3576</li>
                    <li class="nb" style="font-size: 0.8em;" value="4">US: 800-447-3576</li>
                </ul>
            </div>
        </div>
    </body>
</html>